/*! For license information please see app.f39517.js.LICENSE.txt */
"use strict";(self.webpackChunklaravue=self.webpackChunklaravue||[]).push([[1453],{95195:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(51513);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uri=t}var t,n,o;return t=e,(n=[{key:"list",value:function(e){return(0,r.Z)({url:"/"+this.uri,method:"get",params:e})}},{key:"get",value:function(e){return(0,r.Z)({url:"/"+this.uri+"/"+e,method:"get"})}},{key:"store",value:function(e){return(0,r.Z)({url:"/"+this.uri,method:"post",data:e})}},{key:"update",value:function(e,t){return(0,r.Z)({url:"/"+this.uri+"/"+e,method:"put",data:t})}},{key:"destroy",value:function(e){return(0,r.Z)({url:"/"+this.uri+"/"+e,method:"delete"})}}])&&i(t.prototype,n),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}()},67376:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(43202),i={inserted:function(e,t,n){var i=t.value,o=r.Z.getters&&r.Z.getters.permissions;if(!(i&&i instanceof Array&&i.length>0))throw new Error("Permissions are required! Example: v-permission=\"['manage user','manage permission']\"");var s=i,a=o.some((function(e){return s.includes(e)}));a||e.parentNode&&e.parentNode.removeChild(e)}},o=function(e){e.directive("permission",i)};window.Vue&&(window.permission=i,Vue.use(o)),i.install=o;var s=i},61363:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(93379),i=n.n(r),o=n(54083),s={insert:"head",singleton:!1},a=(i()(o.Z,s),o.Z.locals,"@@wavesContext");function l(e,t){function n(n){var r=Object.assign({},t.value),i=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},r),o=i.ele;if(o){o.style.position="relative",o.style.overflow="hidden";var s=o.getBoundingClientRect(),a=o.querySelector(".waves-ripple");if(a?a.className="waves-ripple":((a=document.createElement("span")).className="waves-ripple",a.style.height=a.style.width=Math.max(s.width,s.height)+"px",o.appendChild(a)),"center"===i.type)a.style.top=s.height/2-a.offsetHeight/2+"px",a.style.left=s.width/2-a.offsetWidth/2+"px";else a.style.top=(n.pageY-s.top-a.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",a.style.left=(n.pageX-s.left-a.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px";return a.style.backgroundColor=i.color,a.className="waves-ripple z-active",!1}}return e[a]?e[a].removeHandle=n:e[a]={removeHandle:n},n}var u={bind:function(e,t){e.addEventListener("click",l(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[a].removeHandle,!0),e.addEventListener("click",l(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[a].removeHandle,!1),e[a]=null,delete e[a]}},c=function(e){e.directive("waves",u)};window.Vue&&(window.waves=u,Vue.use(c)),u.install=c;var d=u},59667:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(43202);function i(e){if(e&&e instanceof Array&&e.length>0){var t=r.Z.getters&&r.Z.getters.permissions,n=e;return t.some((function(e){return n.includes(e)}))}return console.error("Need permissions! Like v-permission=\"['manage permission','edit article']\""),!1}},7436:function(e,t,n){var r=n(1519),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,".edit-input[data-v-502efaf8]{padding-right:100px}.cancel-btn[data-v-502efaf8]{position:absolute;right:15px;top:10px}.dialog-footer[data-v-502efaf8]{margin-left:150px;padding-top:0;text-align:left}.app-container[data-v-502efaf8]{-webkit-box-flex:1;-webkit-box-pack:justify;-ms-flex-pack:justify;-ms-flex:1;flex:1;font-size:14px;justify-content:space-between;padding-right:8px}.app-container .block[data-v-502efaf8]{float:left;min-width:250px}.app-container .clear-left[data-v-502efaf8]{clear:left}",""]),t.Z=i},54083:function(e,t,n){var r=n(1519),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,".waves-ripple{background-clip:padding-box;background-color:rgba(0,0,0,.15);border-radius:100%;opacity:1;pointer-events:none;position:absolute;-webkit-transform:scale(0);transform:scale(0);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.waves-ripple.z-active{opacity:0;-webkit-transform:scale(2);transform:scale(2);-webkit-transition:opacity 1.2s ease-out,-webkit-transform .6s ease-out;transition:opacity 1.2s ease-out,-webkit-transform .6s ease-out;transition:opacity 1.2s ease-out,transform .6s ease-out;transition:opacity 1.2s ease-out,transform .6s ease-out,-webkit-transform .6s ease-out}",""]),t.Z=i},39975:function(e,t,n){var r=n(1519),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,".pagination-container[data-v-68c28e9d]{background:#fff;padding:32px 16px}.pagination-container.hidden[data-v-68c28e9d]{display:none}",""]),t.Z=i},33032:function(e,t,n){n.d(t,{Z:function(){return c}});Math.easeInOutQuad=function(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t};var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function i(e,t,n){var i=document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop,o=e-i,s=0;t=void 0===t?500:t;!function e(){s+=20;var a,l=Math.easeInOutQuad(s,i,o,t);a=l,document.documentElement.scrollTop=a,document.body.parentNode.scrollTop=a,document.body.scrollTop=a,s<t?r(e):n&&"function"==typeof n&&n()}()}var o={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,15,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&i(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&i(0,800)}}},s=n(93379),a=n.n(s),l=n(39975),u={insert:"head",singleton:!1},c=(a()(l.Z,u),l.Z.locals,(0,n(51900).Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[n("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)}),[],!1,null,"68c28e9d",null).exports)},51453:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(33032),i=n(51513),o=n(95195);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(s,e);var t,n,r,o=u(s);function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),o.call(this,"users")}return t=s,(n=[{key:"permissions",value:function(e){return(0,i.Z)({url:"/"+this.uri+"/"+e+"/permissions",method:"get"})}},{key:"updatePermission",value:function(e,t){return(0,i.Z)({url:"/"+this.uri+"/"+e+"/permissions",method:"put",data:t})}}])&&a(t.prototype,n),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(o.Z),m=n(61363),p=n(67376),h=n(59667);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function g(){g=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),s=new E(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return L()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=x(s,n);if(a){if(a===c)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c={};function d(){}function f(){}function m(){}var p={};a(p,i,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(C([])));y&&y!==t&&n.call(y,i)&&(p=y);var w=m.prototype=d.prototype=Object.create(p);function b(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(i,o,s,a){var l=u(e[i],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==v(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,a)}))}a(l.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function x(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return f.prototype=m,a(w,"constructor",m),a(m,"constructor",f),f.displayName=a(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,a(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(P.prototype),a(P.prototype,o,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new P(l(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(w),a(w,s,"Generator"),a(w,i,(function(){return this})),a(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}function y(e,t,n,r,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void n(e)}a.done?t(l):Promise.resolve(l).then(r,i)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){y(o,r,i,s,a,"next",e)}function a(e){y(o,r,i,s,a,"throw",e)}s(void 0)}))}}var b=new f,P=new o.Z("permissions"),x={name:"UserList",components:{Pagination:r.Z},directives:{waves:m.Z,permission:p.Z},data:function(){var e=this;return{list:null,total:0,loading:!0,downloading:!1,userCreating:!1,query:{page:1,limit:15,keyword:"",role:""},roles:["admin","manager","editor","user","visitor"],nonAdminRoles:["editor","user","visitor"],newUser:{},dialogFormVisible:!1,dialogPermissionVisible:!1,dialogPermissionLoading:!1,currentUserId:0,currentUser:{name:"",permissions:[],rolePermissions:[]},rules:{role:[{required:!0,message:"Role is required",trigger:"change"}],name:[{required:!0,message:"Name is required",trigger:"blur"}],email:[{required:!0,message:"Email is required",trigger:"blur"},{type:"email",message:"Please input correct email address",trigger:["blur","change"]}],password:[{required:!0,message:"Password is required",trigger:"blur"}],confirmPassword:[{validator:function(t,n,r){n!==e.newUser.password?r(new Error("Password is mismatched!")):r()},trigger:"blur"}]},permissionProps:{children:"children",label:"name",disabled:"disabled"},permissions:[],menuPermissions:[],otherPermissions:[]}},computed:{normalizedMenuPermissions:function(){var e=this,t=[];this.currentUser.permissions.role.forEach((function(e){t.push({id:e.id,name:e.name,disabled:!0})}));var n={id:-1,name:"Inherited from role",disabled:!0,children:this.classifyPermissions(t).menu};return t=this.menuPermissions.filter((function(t){return!e.currentUser.permissions.role.find((function(e){return e.id===t.id}))})),[n,{id:0,name:"Extra menus",children:t,disabled:0===t.length}]},normalizedOtherPermissions:function(){var e=this,t=[];this.currentUser.permissions.role.forEach((function(e){t.push({id:e.id,name:e.name,disabled:!0})}));var n={id:-1,name:"Inherited from role",disabled:!0,children:this.classifyPermissions(t).other};return t=this.otherPermissions.filter((function(t){return!e.currentUser.permissions.role.find((function(e){return e.id===t.id}))})),[n,{id:0,name:"Extra permissions",children:t,disabled:0===t.length}]},userMenuPermissions:function(){return this.classifyPermissions(this.userPermissions).menu},userOtherPermissions:function(){return this.classifyPermissions(this.userPermissions).other},userPermissions:function(){return this.currentUser.permissions.role.concat(this.currentUser.permissions.user)}},created:function(){this.resetNewUser(),this.getList(),(0,h.Z)(["manage permission"])&&this.getPermissions()},methods:{checkPermission:h.Z,getPermissions:function(){var e=this;return w(g().mark((function t(){var n,r,i,o,s,a;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.list({});case 2:n=t.sent,r=n.data,i=e.classifyPermissions(r),o=i.all,s=i.menu,a=i.other,e.permissions=o,e.menuPermissions=s,e.otherPermissions=a;case 8:case"end":return t.stop()}}),t)})))()},getList:function(){var e=this;return w(g().mark((function t(){var n,r,i,o,s,a;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.query,r=n.limit,i=n.page,e.loading=!0,t.next=4,b.list(e.query);case 4:o=t.sent,s=o.data,a=o.meta,e.list=s,e.list.forEach((function(e,t){e.index=(i-1)*r+t+1})),e.total=a.total,e.loading=!1;case 11:case"end":return t.stop()}}),t)})))()},handleFilter:function(){this.query.page=1,this.getList()},handleCreate:function(){var e=this;this.resetNewUser(),this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs.userForm.clearValidate()}))},handleDelete:function(e,t){var n=this;this.$confirm("This will permanently delete user "+t+". Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){b.destroy(e).then((function(e){n.$message({type:"success",message:"Delete completed"}),n.handleFilter()})).catch((function(e){console.log(e)}))})).catch((function(){n.$message({type:"info",message:"Delete canceled"})}))},handleEditPermissions:function(e){var t=this;return w(g().mark((function n(){var r,i,o;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.currentUserId=e,t.dialogPermissionLoading=!0,t.dialogPermissionVisible=!0,r=t.list.find((function(t){return t.id===e})),n.next=6,b.permissions(e);case 6:i=n.sent,o=i.data,t.currentUser={id:r.id,name:r.name,permissions:o},t.dialogPermissionLoading=!1,t.$nextTick((function(){t.$refs.menuPermissions.setCheckedKeys(t.permissionKeys(t.userMenuPermissions)),t.$refs.otherPermissions.setCheckedKeys(t.permissionKeys(t.userOtherPermissions))}));case 11:case"end":return n.stop()}}),n)})))()},createUser:function(){var e=this;this.$refs.userForm.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.newUser.roles=[e.newUser.role],e.userCreating=!0,b.store(e.newUser).then((function(t){e.$message({message:"New user "+e.newUser.name+"("+e.newUser.email+") has been created successfully.",type:"success",duration:5e3}),e.resetNewUser(),e.dialogFormVisible=!1,e.handleFilter()})).catch((function(e){console.log(e)})).finally((function(){e.userCreating=!1}))}))},resetNewUser:function(){this.newUser={name:"",email:"",password:"",confirmPassword:"",role:"user"}},handleDownload:function(){var e=this;this.downloading=!0,Promise.all([n.e(8898),n.e(8516)]).then(n.bind(n,89442)).then((function(t){var n=e.formatJson(["index","id","name","email","role"],e.list);t.export_json_to_excel({header:["id","user_id","name","email","role"],data:n,filename:"user-list"}),e.downloading=!1}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},permissionKeys:function(e){return e.map((function(e){return e.id}))},classifyPermissions:function(e){var t=this,n=[],r=[],i=[];return e.forEach((function(e){var o=e.name;n.push(e),o.startsWith("view menu")?r.push(t.normalizeMenuPermission(e)):i.push(t.normalizePermission(e))})),{all:n,menu:r,other:i}},normalizeMenuPermission:function(e){return{id:e.id,name:this.$options.filters.uppercaseFirst(e.name.substring(10)),disabled:e.disabled||!1}},normalizePermission:function(e){var t=e.disabled||"manage permission"===e.name;return{id:e.id,name:this.$options.filters.uppercaseFirst(e.name),disabled:t}},confirmPermission:function(){var e=this,t=this.$refs.menuPermissions.getCheckedKeys(),n=this.$refs.otherPermissions.getCheckedKeys(),r=t.concat(n);this.dialogPermissionLoading=!0,b.updatePermission(this.currentUserId,{permissions:r}).then((function(t){e.$message({message:"Permissions has been updated successfully",type:"success",duration:5e3}),e.dialogPermissionLoading=!1,e.dialogPermissionVisible=!1}))}}},k=x,_=n(93379),E=n.n(_),C=n(7436),L={insert:"head",singleton:!1},U=(E()(C.Z,L),C.Z.locals,(0,n(51900).Z)(k,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:e.$t("table.keyword")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.query.keyword,callback:function(t){e.$set(e.query,"keyword",t)},expression:"query.keyword"}}),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"90px"},attrs:{placeholder:e.$t("table.role"),clearable:""},on:{change:e.handleFilter},model:{value:e.query.role,callback:function(t){e.$set(e.query,"role",t)},expression:"query.role"}},e._l(e.roles,(function(t){return n("el-option",{key:t,attrs:{label:e._f("uppercaseFirst")(t),value:t}})})),1),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n      "+e._s(e.$t("table.search"))+"\n    ")]),e._v(" "),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("\n      "+e._s(e.$t("table.add"))+"\n    ")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.downloading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("\n      "+e._s(e.$t("table.export"))+"\n    ")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{align:"center",label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.index))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"Email"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.email))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"Role",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.roles.join(", ")))])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"Actions",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.roles.includes("admin")?e._e():n("router-link",{attrs:{to:"/administrator/users/edit/"+t.row.id}},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["manage user"],expression:"['manage user']"}],attrs:{type:"primary",size:"small",icon:"el-icon-edit"}},[e._v("\n            Edit\n          ")])],1),e._v(" "),t.row.roles.includes("admin")?e._e():n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["manage permission"],expression:"['manage permission']"}],attrs:{type:"warning",size:"small",icon:"el-icon-edit"},on:{click:function(n){return e.handleEditPermissions(t.row.id)}}},[e._v("\n          Permissions\n        ")]),e._v(" "),t.row.roles.includes("visitor")?n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["manage user"],expression:"['manage user']"}],attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row.id,t.row.name)}}},[e._v("\n          Delete\n        ")]):e._e()]}}])})],1),e._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.query.page,limit:e.query.limit},on:{"update:page":function(t){return e.$set(e.query,"page",t)},"update:limit":function(t){return e.$set(e.query,"limit",t)},pagination:e.getList}}),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogPermissionVisible,title:"Edit Permissions - "+e.currentUser.name},on:{"update:visible":function(t){e.dialogPermissionVisible=t}}},[e.currentUser.name?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogPermissionLoading,expression:"dialogPermissionLoading"}],staticClass:"form-container"},[n("div",{staticClass:"permissions-container"},[n("div",{staticClass:"block"},[n("el-form",{attrs:{model:e.currentUser,"label-width":"80px","label-position":"top"}},[n("el-form-item",{attrs:{label:"Menus"}},[n("el-tree",{ref:"menuPermissions",staticClass:"permission-tree",attrs:{data:e.normalizedMenuPermissions,"default-checked-keys":e.permissionKeys(e.userMenuPermissions),props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1)],1),e._v(" "),n("div",{staticClass:"block"},[n("el-form",{attrs:{model:e.currentUser,"label-width":"80px","label-position":"top"}},[n("el-form-item",{attrs:{label:"Permissions"}},[n("el-tree",{ref:"otherPermissions",staticClass:"permission-tree",attrs:{data:e.normalizedOtherPermissions,"default-checked-keys":e.permissionKeys(e.userOtherPermissions),props:e.permissionProps,"show-checkbox":"","node-key":"id"}})],1)],1)],1),e._v(" "),n("div",{staticClass:"clear-left"})]),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogPermissionVisible=!1}}},[e._v("\n          "+e._s(e.$t("permission.cancel"))+"\n        ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmPermission}},[e._v("\n          "+e._s(e.$t("permission.confirm"))+"\n        ")])],1)]):e._e()]),e._v(" "),n("el-dialog",{attrs:{title:"Create new user",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.userCreating,expression:"userCreating"}],staticClass:"form-container"},[n("el-form",{ref:"userForm",staticStyle:{"max-width":"500px"},attrs:{rules:e.rules,model:e.newUser,"label-position":"left","label-width":"150px"}},[n("el-form-item",{attrs:{label:e.$t("user.role"),prop:"role"}},[n("el-select",{staticClass:"filter-item",attrs:{placeholder:"Please select role"},model:{value:e.newUser.role,callback:function(t){e.$set(e.newUser,"role",t)},expression:"newUser.role"}},e._l(e.nonAdminRoles,(function(t){return n("el-option",{key:t,attrs:{label:e._f("uppercaseFirst")(t),value:t}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("user.name"),prop:"name"}},[n("el-input",{model:{value:e.newUser.name,callback:function(t){e.$set(e.newUser,"name",t)},expression:"newUser.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("user.email"),prop:"email"}},[n("el-input",{model:{value:e.newUser.email,callback:function(t){e.$set(e.newUser,"email",t)},expression:"newUser.email"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("user.password"),prop:"password"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.newUser.password,callback:function(t){e.$set(e.newUser,"password",t)},expression:"newUser.password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("user.confirmPassword"),prop:"confirmPassword"}},[n("el-input",{attrs:{"show-password":""},model:{value:e.newUser.confirmPassword,callback:function(t){e.$set(e.newUser,"confirmPassword",t)},expression:"newUser.confirmPassword"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n          "+e._s(e.$t("table.cancel"))+"\n        ")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createUser()}}},[e._v("\n          "+e._s(e.$t("table.confirm"))+"\n        ")])],1)],1)])],1)}),[],!1,null,"502efaf8",null).exports)}}]);